(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{5052:(e,s,t)=>{Promise.resolve().then(t.bind(t,5272))},5272:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>ei});var a=t(5155),r=t(2115),i=t(9708),l=t(2085),n=t(9434);let o=(0,l.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),d=r.forwardRef((e,s)=>{let{className:t,variant:r,size:l,asChild:d=!1,...c}=e,m=d?i.DX:"button";return(0,a.jsx)(m,{className:(0,n.cn)(o({variant:r,size:l,className:t})),ref:s,...c})});d.displayName="Button";let c=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{ref:s,className:(0,n.cn)("rounded-xl border bg-card text-card-foreground shadow",t),...r})});c.displayName="Card";let m=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{ref:s,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",t),...r})});m.displayName="CardHeader";let x=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{ref:s,className:(0,n.cn)("font-semibold leading-none tracking-tight",t),...r})});x.displayName="CardTitle";let g=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{ref:s,className:(0,n.cn)("text-sm text-muted-foreground",t),...r})});g.displayName="CardDescription";let u=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{ref:s,className:(0,n.cn)("p-6 pt-0",t),...r})});u.displayName="CardContent",r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{ref:s,className:(0,n.cn)("flex items-center p-6 pt-0",t),...r})}).displayName="CardFooter";let h=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("textarea",{className:(0,n.cn)("flex min-h-[60px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-base shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),ref:s,...r})});h.displayName="Textarea";var f=t(968);let p=(0,l.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),v=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(f.b,{ref:s,className:(0,n.cn)(p(),t),...r})});v.displayName=f.b.displayName;let j=(0,l.F)("inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground shadow hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground shadow hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function N(e){let{className:s,variant:t,...r}=e;return(0,a.jsx)("div",{className:(0,n.cn)(j({variant:t}),s),...r})}var b=t(7484),y=t(5196);let w=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(b.bL,{ref:s,className:(0,n.cn)("peer h-4 w-4 shrink-0 rounded-sm border border-primary shadow focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",t),...r,children:(0,a.jsx)(b.C1,{className:(0,n.cn)("flex items-center justify-center text-current"),children:(0,a.jsx)(y.A,{className:"h-4 w-4"})})})});w.displayName=b.bL.displayName;var C=t(7489);let T=r.forwardRef((e,s)=>{let{className:t,orientation:r="horizontal",decorative:i=!0,...l}=e;return(0,a.jsx)(C.b,{ref:s,decorative:i,orientation:r,className:(0,n.cn)("shrink-0 bg-border","horizontal"===r?"h-[1px] w-full":"h-full w-[1px]",t),...l})});T.displayName=C.b.displayName;var S=t(4439);let A=r.forwardRef((e,s)=>{let{className:t,children:r,...i}=e;return(0,a.jsxs)(S.bL,{ref:s,className:(0,n.cn)("relative overflow-hidden",t),...i,children:[(0,a.jsx)(S.LM,{className:"h-full w-full rounded-[inherit]",children:r}),(0,a.jsx)(O,{}),(0,a.jsx)(S.OK,{})]})});A.displayName=S.bL.displayName;let O=r.forwardRef((e,s)=>{let{className:t,orientation:r="vertical",...i}=e;return(0,a.jsx)(S.VM,{ref:s,orientation:r,className:(0,n.cn)("flex touch-none select-none transition-colors","vertical"===r&&"h-full w-2.5 border-l border-l-transparent p-[1px]","horizontal"===r&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",t),...i,children:(0,a.jsx)(S.lr,{className:"relative flex-1 rounded-full bg-border"})})});O.displayName=S.VM.displayName;var k=t(7234),R=t(4416);let E=k.bL,I=k.l9;k.bm;let D=k.ZL,P=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(k.hJ,{className:(0,n.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...r,ref:s})});P.displayName=k.hJ.displayName;let _=(0,l.F)("fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=closed]:duration-300 data-[state=open]:duration-500 data-[state=open]:animate-in data-[state=closed]:animate-out",{variants:{side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",right:"inset-y-0 right-0 h-full w-3/4 border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm"}},defaultVariants:{side:"right"}}),M=r.forwardRef((e,s)=>{let{side:t="right",className:r,children:i,...l}=e;return(0,a.jsxs)(D,{children:[(0,a.jsx)(P,{}),(0,a.jsxs)(k.UC,{ref:s,className:(0,n.cn)(_({side:t}),r),...l,children:[(0,a.jsxs)(k.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary",children:[(0,a.jsx)(R.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"sr-only",children:"Close"})]}),i]})]})});M.displayName=k.UC.displayName;let z=e=>{let{className:s,...t}=e;return(0,a.jsx)("div",{className:(0,n.cn)("flex flex-col space-y-2 text-center sm:text-left",s),...t})};z.displayName="SheetHeader";let F=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(k.hE,{ref:s,className:(0,n.cn)("text-lg font-semibold text-foreground",t),...r})});F.displayName=k.hE.displayName,r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(k.VY,{ref:s,className:(0,n.cn)("text-sm text-muted-foreground",t),...r})}).displayName=k.VY.displayName;let L=r.forwardRef((e,s)=>{let{className:t,type:r,...i}=e;return(0,a.jsx)("input",{type:r,className:(0,n.cn)("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),ref:s,...i})});L.displayName="Input";var J=t(4783),V=t(4616),U=t(9074),H=t(2525),B=t(7434),X=t(1154),Y=t(5657),G=t(1497),K=t(4357),Q=t(646),Z=t(133),$=t(7481);let q="http://localhost:8000";console.log("=== API Configuration ==="),console.log("API_BASE_URL:",q),console.log("Environment:",{NEXT_PUBLIC_API_URL:"http://localhost:8000",NODE_ENV:"production"}),console.log("=====================");let W=async(e,s)=>{let t="".concat(q).concat(e);console.log("Fetching:",t,s);try{let e=await fetch(t,{...s,headers:{"Content-Type":"application/json",...null==s?void 0:s.headers}});if(console.log("Response status:",e.status),console.log("Response headers:",Object.fromEntries(e.headers.entries())),!e.ok){let s=await e.text();throw console.error("API Error:",e.status,s),Error("API Error: ".concat(e.status," - ").concat(s))}let a=await e.text();console.log("Response text (first 200 chars):",a.substring(0,200));try{let e=JSON.parse(a);return console.log("Parsed JSON data:",e),e}catch(e){throw console.error("JSON parse error:",e),console.error("Full response text:",a),Error("Invalid JSON response: ".concat(a.substring(0,100)))}}catch(e){throw console.error("Fetch error:",e),e}},ee={getSessions:async()=>await W("/sessions"),createSession:async e=>await W("/sessions",{method:"POST",body:JSON.stringify({name:e||"新しいセッション"})}),deleteSession:async e=>await W("/sessions/".concat(e),{method:"DELETE"})},es={getHistories:async e=>await W("/sessions/".concat(e,"/histories")),createHistory:async e=>await W("/histories",{method:"POST",body:JSON.stringify(e)})},et={getProposals:async e=>await W("/histories/".concat(e,"/proposals")),createProposal:async e=>await W("/proposals",{method:"POST",body:JSON.stringify(e)})},ea={generateSuggestions:async e=>await W("/suggestions",{method:"POST",body:JSON.stringify(e)})},er=t(9509).env.NEXT_PUBLIC_FRONTEND_MODE||"real";function ei(){let[e,s]=(0,r.useState)([]),[t,i]=(0,r.useState)(null),[l,n]=(0,r.useState)(!1),[o,f]=(0,r.useState)(!0),[p,j]=(0,r.useState)(!1),[b,y]=(0,r.useState)({original:"",reason:""}),[C,S]=(0,r.useState)(!1),[O,k]=(0,r.useState)(0),{toast:R}=(0,$.dj)(),D=[{id:"1",original:"我并不想回复",reason:"ようがない并非不想的含义，这里可以再看一下这个文法的含义\nようがない：〜できない / 〜したくても手段がない\n不可能であることを強調して言う時に使う。",selected:!1},{id:"2",original:"どんな担任にあったか",reason:"担任指的是学校的老师哦\n担任：学校で，教師があるクラス・教科などを受け持つこと。また，その教師。",selected:!1},{id:"3",original:"有个孩子霸凌年纪比较小的孩子",reason:"这里最好把問題行為译出来哦",selected:!1},{id:"4",original:"",reason:"",selected:!1},{id:"5",original:"",reason:"",selected:!1}],P=e.find(e=>e.id===t),_=(0,r.useCallback)(async()=>{try{console.log("Loading sessions...");let e=await ee.getSessions();console.log("Sessions data received:",e);let t=e.map(e=>({id:e.sessionId,name:e.name,createdAt:new Date(e.createdAt),correctionCount:e.correctionCount,originalText:"",targetText:"",suggestions:[],overallComment:"",savedData:[]}));s(t)}catch(e){console.error("Error loading sessions:",e)}},[]),q=async e=>{try{console.log("Loading session details for:",e);let t=await es.getHistories(e);console.log("Histories for session",e,":",t);let a=[];for(let e of t){let s=(await et.getProposals(e.historyId)).map(e=>({id:e.proposalId,original:e.originalAfterText,reason:e.originalReason||"",selected:1===e.isSelected,selectedOrder:e.selectedOrder,userModifiedReason:e.modifiedReason,isCustom:1===e.isCustom}));a.push({originalText:e.originalText,instructionPrompt:e.instructionPrompt,targetText:e.targetText,aiSuggestions:s,selectedCorrections:s.filter(e=>e.selected),overallComment:e.combinedComment,combinedComment:e.combinedComment,timestamp:new Date(e.timestamp)})}s(s=>s.map(s=>s.id===e?{...s,savedData:a}:s))}catch(e){console.error("Error loading session details:",e)}},W=async()=>{try{let t=await ee.createSession("セッション ".concat(e.length+1)),a={id:t.sessionId,name:t.name,createdAt:new Date(t.createdAt),correctionCount:0,originalText:"",targetText:"",suggestions:[],overallComment:"",savedData:[]};s(e=>[a,...e]),i(a.id),n(!1),k(0)}catch(e){console.error("Failed to create session:",e),R({title:"エラー",description:"セッションの作成に失敗しました",variant:"destructive"})}},ei=async a=>{try{if(await ee.deleteSession(a),s(e=>e.filter(e=>e.id!==a)),t===a){let s=e.filter(e=>e.id!==a);i(s.length>0?s[0].id:null)}}catch(e){console.error("Failed to delete session:",e),R({title:"エラー",description:"セッションの削除に失敗しました",variant:"destructive"})}},el=e=>{t&&s(s=>s.map(s=>s.id===t?{...s,...e}:s))},en=async()=>{if(!(null==P?void 0:P.targetText.trim()))return;j(!0);let e=new Map,s=[];if(P.suggestions.length>0&&P.suggestions.forEach(t=>{t.isCustom?s.push(t):(t.selected||t.userModifiedReason)&&e.set(t.original,{selected:t.selected,selectedOrder:t.selectedOrder,userModifiedReason:t.userModifiedReason})}),"mock"===er){let t=[...D.map(s=>{let t=e.get(s.original);return t?{...s,...t}:{...s,selected:!1,selectedOrder:void 0}}),...s];el({suggestions:t,overallComment:"译文整体的流畅性和对原意翻译处理和展现比较不错，可以再看一下以上几点，注意积累一下ようがない和担任的含义，加油～"}),S(!0),k(t.filter(e=>e.selected).length),j(!1);return}try{let t=await ea.generateSuggestions({originalText:P.originalText,targetText:P.targetText,instructionPrompt:"CCTalkからの添削指示",sessionId:P.id,engine:"gemini"}),a=[...t.suggestions.map(s=>{let t=e.get(s.original);return t?{...s,...t}:{...s,selected:!1,selectedOrder:void 0}}),...s];el({suggestions:a,overallComment:t.overallComment}),S(!0);let r=a.filter(e=>e.selected).length;k(r)}catch(e){R({title:"APIエラー",description:"AI提案の取得に失敗しました",variant:"destructive"})}finally{j(!1)}},eo=e=>{let s;if(!P)return;let t=P.suggestions.find(s=>s.id===e);if(!t)return;let a=O;if(t.selected){let e=t.selectedOrder;e&&(el({suggestions:P.suggestions.map(s=>s.selectedOrder&&s.selectedOrder>e?{...s,selectedOrder:s.selectedOrder-1}:s)}),a-=1),s=void 0}else a+=1,s=a;el({suggestions:P.suggestions.map(t=>t.id===e?{...t,selected:!t.selected,selectedOrder:s}:t)}),k(a)},ed=(e,s)=>{P&&el({suggestions:P.suggestions.map(t=>t.id===e?{...t,userModifiedReason:s}:t)})},ec=async e=>{try{await navigator.clipboard.writeText(e),R({title:"コピー完了",description:"修正内容がクリップボードにコピーされました"})}catch(e){R({title:"コピー失敗",description:"クリップボードへのコピーに失敗しました",variant:"destructive"})}},em=async()=>{if(!P)return;let e=P.suggestions.filter(e=>e.selected).sort((e,s)=>(e.selectedOrder||0)-(s.selectedOrder||0));if(e.length<3)return void R({title:"選択不足",description:"3つ以上の修正内容を選択してください",variant:"destructive"});try{let s={sessionId:P.id,originalText:P.originalText,targetText:P.targetText,instructionPrompt:"CCTalkからの添削指示",combinedComment:P.overallComment,selectedProposalIds:JSON.stringify(e.map(e=>e.id)),customProposals:JSON.stringify(e.filter(e=>e.isCustom))},t=await es.createHistory(s);for(let e of P.suggestions){let s={historyId:t.historyId,type:e.isCustom?"Custom":"AI",originalAfterText:e.original,originalReason:e.reason,modifiedAfterText:(e.userModifiedReason,e.original),modifiedReason:e.userModifiedReason||e.reason,isSelected:+!!e.selected,isModified:+!!e.userModifiedReason,isCustom:+!!e.isCustom,selectedOrder:e.selected?e.selectedOrder:void 0};await et.createProposal(s)}let a=e.map((e,s)=>{let t=e.userModifiedReason||e.reason;return"".concat(s+1,".").concat(e.original,"\n").concat(t)}).join("\n\n"),r="".concat(a,"\n\n").concat(P.overallComment);await ec(r);let i={originalText:P.originalText,instructionPrompt:"CCTalkからの添削指示",targetText:P.targetText,aiSuggestions:P.suggestions,selectedCorrections:e,overallComment:P.overallComment,combinedComment:r,timestamp:new Date};el({savedData:[...P.savedData,i],targetText:"",suggestions:[],overallComment:""}),S(!1),y({original:"",reason:""}),k(0),R({title:"保存完了",description:"修正内容が保存され、クリップボードにコピーされました"})}catch(e){console.error("Failed to save corrections:",e),R({title:"エラー",description:"修正内容の保存に失敗しました",variant:"destructive"})}},ex=e=>{P&&(el({originalText:e.originalText,targetText:e.targetText,suggestions:e.aiSuggestions.map(e=>({...e,selected:e.selected||!1,selectedOrder:e.selectedOrder})),overallComment:e.overallComment}),k(e.aiSuggestions.filter(e=>e.selected).length),S(!0),R({title:"履歴を復元しました",description:"選択した履歴データが現在のセッションに復元されました"}))},eg=(null==P?void 0:P.suggestions.filter(e=>e.selected).length)||0,eu=eg>=3,eh=s=>{let{collapsed:r=!1}=s;return(0,a.jsxs)("div",{className:"h-full flex flex-col ".concat(r?"items-center w-16":""),children:[(0,a.jsxs)("div",{className:"p-4 border-b ".concat(r?"px-2":""),children:[!r&&(0,a.jsxs)(d,{onClick:W,className:"w-full",size:"sm",children:[(0,a.jsx)(V.A,{className:"w-4 h-4 mr-2"}),"新しいセッション"]}),r&&(0,a.jsx)(d,{onClick:W,size:"icon",className:"w-8 h-8",children:(0,a.jsx)(V.A,{className:"w-4 h-4"})})]}),(0,a.jsx)(A,{className:"flex-1 ".concat(r?"px-1":"p-4"),children:(0,a.jsxs)("div",{className:"space-y-2",children:[e.map(e=>(0,a.jsx)("div",{className:"group p-3 rounded-lg border cursor-pointer transition-colors ".concat(t===e.id?"bg-blue-50 border-blue-200":"hover:bg-gray-50"," ").concat(r?"p-1":""),onClick:()=>{i(e.id),n(!1),q(e.id)},children:(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("h3",{className:"font-medium text-sm truncate ".concat(r?"hidden":""),children:e.name}),(0,a.jsxs)("div",{className:"flex items-center gap-2 mt-1 ".concat(r?"justify-center":""),children:[(0,a.jsx)(U.A,{className:"w-3 h-3 text-gray-400"}),!r&&(0,a.jsx)("span",{className:"text-xs text-gray-500",children:e.createdAt.toLocaleDateString()})]}),(0,a.jsxs)(N,{variant:"secondary",className:"mt-2 ".concat(r?"mx-auto block":""),children:["保存済み: ",e.correctionCount,"件"]})]}),!r&&(0,a.jsx)(d,{variant:"ghost",size:"sm",onClick:s=>{s.stopPropagation(),ei(e.id)},className:"opacity-0 group-hover:opacity-100 transition-opacity",children:(0,a.jsx)(H.A,{className:"w-3 h-3"})})]})},e.id)),0===e.length&&(0,a.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,a.jsx)(B.A,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),(0,a.jsx)("p",{className:"text-sm",children:"セッションがありません"})]})]})})]})};return(0,r.useEffect)(()=>{_()},[_]),(0,a.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100",children:[(0,a.jsxs)(E,{open:l,onOpenChange:n,children:[(0,a.jsx)(I,{asChild:!0,children:(0,a.jsx)(d,{variant:"outline",size:"sm",className:"fixed top-4 left-4 z-50 lg:hidden bg-white shadow-md",children:(0,a.jsx)(J.A,{className:"w-4 h-4"})})}),(0,a.jsxs)(M,{side:"left",className:"w-80 p-0",children:[(0,a.jsx)(z,{className:"p-4 border-b",children:(0,a.jsx)(F,{children:"セッション管理"})}),(0,a.jsx)(eh,{})]})]}),(0,a.jsxs)("div",{className:"flex h-screen",children:[!o&&(0,a.jsx)(d,{variant:"outline",size:"sm",onClick:()=>f(!0),className:"fixed top-4 left-4 z-50 hidden lg:block bg-white shadow-md",children:(0,a.jsx)(J.A,{className:"w-4 h-4"})}),o&&(0,a.jsxs)("div",{className:"hidden lg:block w-80 bg-white border-r shadow-sm transition-all duration-300",children:[(0,a.jsx)(e=>{let{isDesktop:s=!1}=e;return(0,a.jsx)("div",{className:"p-4 border-b",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("h1",{className:"text-lg font-bold text-gray-900",children:o||!s?"CCTalk 添削システム":"CCTalk"}),s&&(0,a.jsx)(d,{variant:"ghost",size:"sm",onClick:()=>f(!o),className:"h-8 w-8 p-0",children:(0,a.jsx)(J.A,{className:"w-4 h-4"})})]})})},{isDesktop:!0}),(0,a.jsx)(eh,{})]}),(0,a.jsx)("div",{className:"flex-1 overflow-auto",children:(0,a.jsx)("div",{className:"p-4 lg:p-8",children:(0,a.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,a.jsx)("div",{className:"lg:hidden mb-6 pt-12",children:(0,a.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"CCTalk 添削システム"})}),P?(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-xl font-bold text-gray-900",children:P.name}),(0,a.jsxs)("p",{className:"text-sm text-gray-500",children:["作成日: ",P.createdAt.toLocaleString()]})]}),P.savedData.length>0&&(0,a.jsxs)(N,{variant:"outline",children:["保存済み: ",P.savedData.length,"件"]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{className:"space-y-6 xl:sticky xl:top-6 xl:h-fit",children:[(0,a.jsxs)(c,{children:[(0,a.jsxs)(m,{children:[(0,a.jsx)(x,{className:"text-lg",children:"原文テキスト"}),(0,a.jsx)(g,{children:"CCTalkから原文テキストをコピー&ペーストしてください"})]}),(0,a.jsx)(u,{children:(0,a.jsx)(h,{placeholder:"原文テキストをここに貼り付けてください...",value:P.originalText,onChange:e=>el({originalText:e.target.value}),className:"min-h-[200px] text-base leading-relaxed"})})]}),(0,a.jsxs)(c,{children:[(0,a.jsxs)(m,{children:[(0,a.jsx)(x,{className:"text-lg",children:"添削対象テキスト"}),(0,a.jsx)(g,{children:"添削したいテキストをコピー&ペーストしてください"})]}),(0,a.jsxs)(u,{className:"space-y-4",children:[(0,a.jsx)(h,{placeholder:"添削対象テキストをここに貼り付けてください...",value:P.targetText,onChange:e=>el({targetText:e.target.value}),className:"min-h-[250px] text-base leading-relaxed"}),(0,a.jsx)(d,{onClick:en,disabled:!P.targetText.trim()||p,className:"w-full",children:p?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(X.A,{className:"w-4 h-4 mr-2 animate-spin"}),"AI分析中..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(Y.A,{className:"w-4 h-4 mr-2"}),"AI提案を生成"]})})]})]})]}),(0,a.jsxs)("div",{className:"space-y-6",children:[P.suggestions.length>0&&(0,a.jsxs)(c,{children:[(0,a.jsxs)(m,{children:[(0,a.jsxs)(x,{className:"flex items-center gap-2",children:[(0,a.jsx)(Y.A,{className:"w-5 h-5 text-blue-600"}),"AI修正提案"]}),(0,a.jsx)(g,{children:"以下の提案から3つ以上選択してください。修正内容とコメントは編集可能です。"}),(0,a.jsxs)("div",{className:"flex items-center gap-2 flex-wrap",children:[(0,a.jsxs)(N,{variant:eu?"default":"secondary",children:["選択済み: ",eg,"/5+"]}),eu&&(0,a.jsx)(N,{variant:"outline",className:"text-green-600",children:"保存可能"})]})]}),(0,a.jsxs)(u,{className:"space-y-4",children:[P.suggestions.map(e=>(0,a.jsx)("div",{className:"border rounded-lg p-4 space-y-3",children:(0,a.jsxs)("div",{className:"flex items-start gap-4",children:[(0,a.jsxs)("div",{className:"flex flex-col items-center gap-2",children:[(0,a.jsx)(w,{checked:e.selected,onCheckedChange:()=>eo(e.id),className:"h-5 w-5"}),e.selected&&e.selectedOrder&&(0,a.jsx)(N,{variant:"outline",className:"text-xs px-1 py-0",children:e.selectedOrder})]}),(0,a.jsxs)("div",{className:"flex-1 space-y-3",children:[e.isCustom&&(0,a.jsx)(N,{variant:"outline",className:"text-purple-600 border-purple-200",children:"カスタム修正"}),(0,a.jsx)("div",{className:"grid grid-cols-1 gap-4",children:(0,a.jsxs)("div",{children:[(0,a.jsx)(v,{className:"text-sm font-medium text-red-600",children:"指摘箇所"}),(0,a.jsx)("p",{className:"bg-red-50 p-3 rounded border text-sm mt-1 leading-relaxed",children:e.original})]})}),(0,a.jsxs)("div",{className:"bg-blue-50 p-3 rounded",children:[(0,a.jsx)(v,{className:"text-sm font-medium text-blue-600",children:"修正コメント"}),e.selected?(0,a.jsx)(h,{value:e.userModifiedReason||e.reason,onChange:s=>ed(e.id,s.target.value),className:"text-sm min-h-[80px] mt-1 bg-white"}):(0,a.jsx)("p",{className:"text-sm text-blue-800 mt-1 leading-relaxed",children:e.reason})]})]})]})},e.id)),C&&(0,a.jsxs)("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-4 space-y-4 bg-gray-50",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(V.A,{className:"w-4 h-4 text-gray-600"}),(0,a.jsx)(v,{className:"text-sm font-medium text-gray-700",children:"修正内容を追加"})]}),(0,a.jsx)("div",{className:"grid grid-cols-1 gap-4",children:(0,a.jsxs)("div",{children:[(0,a.jsx)(v,{htmlFor:"custom-original",className:"text-sm font-medium text-red-600",children:"修正前のテキスト"}),(0,a.jsx)(L,{id:"custom-original",value:b.original,onChange:e=>y(s=>({...s,original:e.target.value})),placeholder:"修正前のテキストを入力",className:"mt-1"})]})}),(0,a.jsxs)("div",{children:[(0,a.jsx)(v,{htmlFor:"custom-reason",className:"text-sm font-medium text-blue-600",children:"修正コメント"}),(0,a.jsx)(h,{id:"custom-reason",value:b.reason,onChange:e=>y(s=>({...s,reason:e.target.value})),placeholder:"修正コメントを入力",className:"min-h-[80px] mt-1"})]}),(0,a.jsxs)(d,{onClick:()=>{if(!P||!b.original||!b.reason)return void R({title:"入力エラー",description:"すべての項目を入力してください",variant:"destructive"});let e=O+1,s={id:"custom-".concat(Date.now()),original:b.original,reason:b.reason,selected:!0,selectedOrder:e,isCustom:!0};el({suggestions:[...P.suggestions,s]}),y({original:"",reason:""}),k(e),R({title:"修正内容を追加しました",description:"カスタム修正内容が追加され、自動的に選択されました"})},size:"sm",className:"w-full",children:[(0,a.jsx)(V.A,{className:"w-4 h-4 mr-2"}),"修正内容を追加"]})]}),P.overallComment&&(0,a.jsxs)("div",{className:"border rounded-lg p-4 bg-yellow-50",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[(0,a.jsx)(G.A,{className:"w-4 h-4 text-yellow-600"}),(0,a.jsx)(v,{className:"text-sm font-medium text-yellow-700",children:"全体総括コメント"})]}),(0,a.jsx)(h,{value:P.overallComment,onChange:e=>el({overallComment:e.target.value}),className:"min-h-[100px] bg-white",placeholder:"全体的な総括コメントを入力してください..."})]}),(0,a.jsx)(T,{}),(0,a.jsxs)(d,{onClick:em,disabled:!eu,className:"w-full",size:"lg",children:[(0,a.jsx)(K.A,{className:"w-4 h-4 mr-2"}),"確定してコピー・保存 (",eg,"/3)"]})]})]}),P.savedData.length>0&&(0,a.jsxs)(c,{children:[(0,a.jsxs)(m,{children:[(0,a.jsxs)(x,{className:"flex items-center gap-2",children:[(0,a.jsx)(Q.A,{className:"w-5 h-5 text-green-600"}),"保存履歴"]}),(0,a.jsx)(g,{children:"このセッションで保存された添削データ"})]}),(0,a.jsx)(u,{children:(0,a.jsx)("div",{className:"space-y-3",children:P.savedData.map((e,s)=>(0,a.jsx)("div",{className:"border rounded-lg p-4 space-y-3",children:(0,a.jsxs)("div",{className:"flex justify-between items-start",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("h4",{className:"font-medium text-sm",children:["添削データ #",s+1]}),(0,a.jsx)("p",{className:"text-xs text-gray-500",children:e.timestamp.toLocaleString()})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)(d,{variant:"outline",size:"sm",onClick:()=>ex(e),children:[(0,a.jsx)(Z.A,{className:"w-3 h-3 mr-1"}),"復元"]}),(0,a.jsxs)(d,{variant:"outline",size:"sm",onClick:()=>console.log("削除機能未実装"),children:[(0,a.jsx)(H.A,{className:"w-3 h-3 mr-1"}),"削除"]})]})]})},s))})})]})]})]})]}):(0,a.jsxs)(c,{className:"max-w-md mx-auto",children:[(0,a.jsxs)(m,{className:"text-center",children:[(0,a.jsx)(B.A,{className:"w-12 h-12 mx-auto mb-4 text-blue-600"}),(0,a.jsx)(x,{children:"セッションを開始"}),(0,a.jsx)(g,{children:"新しいセッションを作成して添削を開始しましょう"})]}),(0,a.jsx)(u,{children:(0,a.jsx)(d,{onClick:W,className:"w-full",size:"lg",children:"新しいセッション作成"})})]})]})})})]})]})}},7481:(e,s,t)=>{"use strict";t.d(s,{dj:()=>x});var a=t(2115);let r=0,i=new Map,l=e=>{if(i.has(e))return;let s=setTimeout(()=>{i.delete(e),c({type:"REMOVE_TOAST",toastId:e})},1e6);i.set(e,s)},n=(e,s)=>{switch(s.type){case"ADD_TOAST":return{...e,toasts:[s.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===s.toast.id?{...e,...s.toast}:e)};case"DISMISS_TOAST":{let{toastId:t}=s;return t?l(t):e.toasts.forEach(e=>{l(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===t||void 0===t?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===s.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==s.toastId)}}},o=[],d={toasts:[]};function c(e){d=n(d,e),o.forEach(e=>{e(d)})}function m(e){let{...s}=e,t=(r=(r+1)%Number.MAX_SAFE_INTEGER).toString(),a=()=>c({type:"DISMISS_TOAST",toastId:t});return c({type:"ADD_TOAST",toast:{...s,id:t,open:!0,onOpenChange:e=>{e||a()}}}),{id:t,dismiss:a,update:e=>c({type:"UPDATE_TOAST",toast:{...e,id:t}})}}function x(){let[e,s]=a.useState(d);return a.useEffect(()=>(o.push(s),()=>{let e=o.indexOf(s);e>-1&&o.splice(e,1)}),[e]),{...e,toast:m,dismiss:e=>c({type:"DISMISS_TOAST",toastId:e})}}},9434:(e,s,t)=>{"use strict";t.d(s,{cn:()=>i});var a=t(2596),r=t(9688);function i(){for(var e=arguments.length,s=Array(e),t=0;t<e;t++)s[t]=arguments[t];return(0,r.QP)((0,a.$)(s))}}},e=>{var s=s=>e(e.s=s);e.O(0,[470,864,441,684,358],()=>s(5052)),_N_E=e.O()}]);